<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta
			name="keywords"
			content="简历,简历在线,简历制作,简历免费,免费简历,简历生成"
		/>
		<meta name="author" content="queuecat.top" />
		<meta
			name="description"
			content="简历在线制作,在页面中在线编写简历,并将制作的简历保存"
		/>
		<link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon" />
		<link rel="stylesheet" href="./css/index.css" />
		<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
		<!-- 引入element-ui样式 -->
		<link
			rel="stylesheet"
			href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"
		/>
		<!-- 引入element-ui组件库 -->
		<script src="https://unpkg.com/element-ui/lib/index.js"></script>
		<!-- jspdf -->
		<script src="https://cdn.bootcdn.net/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>

		<!-- html2canvas -->
		<script src="./js/html2canvas.js"></script>

		<title>简历制作</title>
	</head>
	<body>
		<div id="app">
			<div class="mainBox">
				<div class="main">
					<div class="header">个人简历</div>
					<div class="personal-info"></div>
				</div>
			</div>
			<div class="main-tools"></div>
			<div class="tools">
				<h3>模块管理</h3>
				<p>清除现有模块</p>
				<ul class="show">
					<li>
						<i class="logo el-icon-user"></i>
						<span>基本信息</span>
						<div class="btn">
							<!-- <el-checkbox v-model="checked">照片</el-checkbox> -->
							<input type="checkbox" name="" id="img" />
							<label for="img">照片</label>
						</div>
					</li>

					<li v-for="item in showModule">
						<i class="logo" :class="item.logo"></i>
						<span>{{item.name}}</span>
						<div class="show btn" @click="insertItem(item)">
							<i class="el-icon-remove-outline"></i>
						</div>
					</li>
				</ul>
				<p v-show="hideModule.length > 0">添加模块</p>
				<ul class="hide">
					<li v-for="item in hideModule" @click="deleteItem(item)">
						<i class="logo" :class="item.logo"></i>
						<span>{{item.name}}</span>
						<p class="content">{{item.content}}</p>
						<div class="show btn">
							<i class="el-icon-circle-plus-outline"></i>
						</div>
					</li>
				</ul>
				<el-button @click="download" class="download" type="primary"
					>生成简历</el-button
				>
			</div>
		</div>
		<script>
			var vm = new Vue({
				el: '#app',
				data() {
					return {
						showModule: [
							{
								name: '求职意向',
								logo: 'el-icon-position',
								content: '职位要求信息',
								children: [],
							},
							{
								name: '项目经历',
								logo: 'el-icon-notebook-2',
								content: '展示专业领域的项目与能力',
								children: [],
							},
							{
								name: '自我评价',
								logo: 'el-icon-mic',
								content: '突出个人求职优势',
								children: [],
							},
							{
								name: '工作经历',
								logo: 'el-icon-suitcase',
								content: '展示工作经历，突出相关能力',
								children: [],
							},
							{
								name: '在校经历',
								logo: 'el-icon-office-building',
								content: '描述学历背景及专业信息',
								children: [],
							},
						],
						hideModule: [
							{
								name: '教育经历',
								logo: 'el-icon-date',
								content: '展示人际交往与团队合作能力',
								children: [],
							},
							{
								name: '实习经历',
								logo: 'el-icon-data-analysis',
								content: '突出相关经验，展示自身能力',
								children: [],
							},
							{
								name: '相关技能',
								logo: 'el-icon-setting',
								content: '列举自己强项与掌握的技能',
								children: [],
							},
							{
								name: '荣誉证书',
								logo: 'el-icon-trophy',
								content: '列出自己掌握的技能与强项',
								children: [],
							},
						],
					};
				},
				methods: {
					deleteItem(item) {
						this.showModule.push(item);
						this.hideModule.splice(this.hideModule.indexOf(item), 1);
					},
					insertItem(item) {
						this.hideModule.unshift(item);
						this.showModule.splice(this.hideModule.indexOf(item), 1);
					},
					// 下载简历
					download() {
						// var shareContent = document.querySelector('#app .mainBox .main'); //需要截图的包裹的（原生的）DOM 对象
						var shareContent = document.querySelector('.tools'); //需要截图的包裹的（原生的）DOM 对象

						// 使用html2canvas将dom导出为图片
						let opts = {
							scale: 6, // 添加的scale 参数
							dpi: 300,
							useCORS: true, // 【重要】开启跨域配置
						};
						html2canvas(shareContent, opts).then((canvas) => {
							// a标签设置donwload属性
							// let a = document.createElement('a');
							// a.href = canvas.toDataURL();
							// a.download = '个人简历';
							// a.click();
							// a.remove();
							// 生成pdf
							var contentWidth = canvas.width;
							var contentHeight = canvas.height;
							//一页pdf显示html页面生成的canvas高度;
							var pageHeight = (contentWidth / 592.28) * 841.89;
							//未生成pdf的html页面高度
							var leftHeight = contentHeight;
							//页面偏移
							var position = 0;
							//a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
							var imgWidth = 595.28;
							var imgHeight = (592.28 / contentWidth) * contentHeight;
							var pageData = canvas.toDataURL('image/jpeg', 1.0);
							var pdf = new jsPDF('', 'pt', 'a4');
							//有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
							//当内容未超过pdf一页显示的范围，无需分页
							if (leftHeight < pageHeight) {
								pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight);
							} else {
								while (leftHeight > 0) {
									pdf.addImage(
										pageData,
										'JPEG',
										0,
										position,
										imgWidth,
										imgHeight
									);
									leftHeight -= pageHeight;
									position -= 841.89;
									//避免添加空白页
									if (leftHeight > 0) {
										pdf.addPage();
									}
								}
							}
							pdf.save('content.pdf');
						});

						// html转pdf
						/*	var doc = new jsPDF();

						// We'll make our own renderer to skip this editor
						var specialElementHandlers = {
							'#editor': function (element, renderer) {
								return true;
							},
						};

						// All units are in the set measurement for the document
						// This can be changed to "pt" (points), "mm" (Default), "cm", "in"
						doc.fromHTML(shareContent, 15, 15, {
							width: 170,
							elementHandlers: specialElementHandlers,
						});
						doc.save('content.pdf');*/
					},
				},
			});
		</script>
	</body>
</html>
